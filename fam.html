<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - منصة إدارة شؤون العائلة</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4e73df;
            --secondary: #6f42c1;
            --success: #1cc88a;
            --info: #36b9cc;
            --warning: #f6c23e;
            --danger: #e74a3b;
            --light: #f8f9fc;
            --dark: #5a5c69;
        }
        
        * {
            font-family: 'Cairo', sans-serif;
        }
        
        body {
            background-color: #f8f9fc;
            color: #444;
            padding-top: 60px;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar {
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            top: 0;
            right: 0;
            padding-top: 60px;
            width: 250px;
            box-shadow: 3px 0 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            padding: 15px 20px;
            margin: 5px 0;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .sidebar .nav-link.active {
            color: white;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .sidebar .nav-link i {
            margin-left: 10px;
        }
        
        .main-content {
            margin-right: 250px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .dashboard-card {
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .card-calendar {
            border-left: 4px solid var(--success);
        }
        
        .card-expenses {
            border-left: 4px solid var(--info);
        }
        
        .card-notes {
            border-left: 4px solid var(--warning);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .family-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white;
        }
        
        .family-event {
            border-right: 3px solid var(--primary);
            background-color: rgba(78, 115, 223, 0.1);
        }
        
        .expense-item {
            border-bottom: 1px solid #eee;
            padding: 10px 0;
        }
        
        .progress {
            height: 10px;
            border-radius: 5px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: #3a5fc8;
            border-color: #3a5fc8;
        }
        
        .section-title {
            position: relative;
            padding-bottom: 15px;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
                text-align: center;
            }
            
            .sidebar .nav-link span {
                display: none;
            }
            
            .sidebar .nav-link i {
                margin: 0;
                font-size: 1.5rem;
            }
            
            .main-content {
                margin-right: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- شريط التنقل -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="#">
                <i class="fas fa-home me-2"></i>
                منصة إدارة شؤون العائلة
            </a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <img src="https://ui-avatars.com/api/?name=الأب&background=4e73df&color=fff" class="family-img me-2">
                            الأب
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">الملف الشخصي</a></li>
                            <li><a class="dropdown-item" href="#">الإعدادات</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">تسجيل الخروج</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- الشريط الجانبي -->
    <div class="sidebar">
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link active" href="dashboard.html">
                    <i class="fas fa-home"></i>
                    <span>لوحة التحكم</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="calendar.html">
                    <i class="fas fa-calendar-alt"></i>
                    <span>التقويم العائلي</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="expenses.html">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>إدارة المصروفات</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="notes.html">
                    <i class="fas fa-sticky-note"></i>
                    <span>ملاحظات العائلة</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="members.html">
                    <i class="fas fa-users"></i>
                    <span>أفراد العائلة</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="reports.html">
                    <i class="fas fa-chart-pie"></i>
                    <span>التقارير</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="settings.html">
                    <i class="fas fa-cog"></i>
                    <span>الإعدادات</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- المحتوى الرئيسي -->
    <div class="main-content">
        <div class="container-fluid">
            <!-- إحصائيات سريعة -->
            <div class="row mb-4">
                <div class="col-12">
                    <h2 class="section-title">لوحة تحكم العائلة</h2>
                </div>
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card dashboard-card h-100">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">أحداث هذا الشهر</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="events-count">8 أحداث</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-calendar-alt fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card dashboard-card h-100">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">المصروفات الشهرية</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="expenses-total">2,450 ريال</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-money-bill-wave fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card dashboard-card h-100">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1">أفراد العائلة</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="members-count">5 أفراد</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-users fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card dashboard-card h-100">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">ملاحظات نشطة</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800" id="notes-count">12 ملاحظة</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-sticky-note fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- المحتوى الرئيسي -->
            <div class="row">
                <!-- التقويم العائلي -->
                <div class="col-lg-6 mb-4">
                    <div class="card shadow h-100">
                        <div class="card-header py-3 d-flex justify-content-between align-items-center">
                            <h6 class="m-0 font-weight-bold text-primary">التقويم العائلي - الأحداث القادمة</h6>
                            <a href="calendar.html" class="btn btn-sm btn-primary">عرض الكل</a>
                        </div>
                        <div class="card-body">
                            <div class="list-group" id="upcoming-events">
                                <a href="#" class="list-group-item list-group-item-action family-event">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">حفل عيد ميلاد أحمد</h6>
                                        <small>غداً</small>
                                    </div>
                                    <p class="mb-1">الوقت: 5:00 مساءً</p>
                                    <small>المكان: منزلنا</small>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action family-event">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">موعد طبيب سارة</h6>
                                        <small>بعد غد</small>
                                    </div>
                                    <p class="mb-1">الوقت: 10:00 صباحاً</p>
                                    <small>المكان: مستشفى المدينة</small>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action family-event">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">اجتماع أولياء الأمور</h6>
                                        <small>الأسبوع القادم</small>
                                    </div>
                                    <p class="mb-1">الوقت: 3:00 مساءً</p>
                                    <small>المكان: مدرسة النخيل</small>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- إدارة المصروفات -->
                <div class="col-lg-6 mb-4">
                    <div class="card shadow h-100">
                        <div class="card-header py-3 d-flex justify-content-between align-items-center">
                            <h6 class="m-0 font-weight-bold text-primary">إدارة المصروفات - ملخص الشهر</h6>
                            <a href="expenses.html" class="btn btn-sm btn-primary">عرض الكل</a>
                        </div>
                        <div class="card-body">
                            <h6 class="font-weight-bold">ميزانية الشهر الحالي</h6>
                            <div class="progress mb-4">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 65%" id="budget-progress"></div>
                            </div>
                            
                            <div class="expense-item d-flex justify-content-between">
                                <div>
                                    <h6 class="mb-0">البقالة</h6>
                                    <small class="text-muted">20 أكتوبر</small>
                                </div>
                                <span class="text-danger">- 320 ريال</span>
                            </div>
                            
                            <div class="expense-item d-flex justify-content-between">
                                <div>
                                    <h6 class="mb-0">فواتير الكهرباء</h6>
                                    <small class="text-muted">18 أكتوبر</small>
                                </div>
                                <span class="text-danger">- 240 ريال</span>
                            </div>
                            
                            <div class="expense-item d-flex justify-content-between">
                                <div>
                                    <h6 class="mb-0">مصاريف الدراسة</h6>
                                    <small class="text-muted">15 أكتوبر</small>
                                </div>
                                <span class="text-danger">- 450 ريال</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ملاحظات العائلة -->
                <div class="col-lg-6 mb-4">
                    <div class="card shadow h-100">
                        <div class="card-header py-3 d-flex justify-content-between align-items-center">
                            <h6 class="m-0 font-weight-bold text-primary">ملاحظات العائلة</h6>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addNoteModal">
                                إضافة ملاحظة
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="chat-container" id="family-notes">
                                <div class="d-flex mb-4">
                                    <img src="https://ui-avatars.com/api/?name=الأب&background=4e73df&color=fff" class="family-img me-3">
                                    <div class="flex-grow-1">
                                        <div class="bg-light p-3 rounded">
                                            <h6 class="mb-1">الأب</h6>
                                            <p class="mb-0">لا تنسوا موعد الطبيب غداً الساعة 10 صباحاً</p>
                                            <small class="text-muted">منذ ساعتين</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex mb-4">
                                    <img src="https://ui-avatars.com/api/?name=الأم&background=6f42c1&color=fff" class="family-img me-3">
                                    <div class="flex-grow-1">
                                        <div class="bg-light p-3 rounded">
                                            <h6 class="mb-1">الأم</h6>
                                            <p class="mb-0">يجب شراء مستلزمات الدراسة للأطفال</p>
                                            <small class="text-muted">منذ 5 ساعات</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-flex">
                                    <img src="https://ui-avatars.com/api/?name=أحمد&background=1cc88a&color=fff" class="family-img me-3">
                                    <div class="flex-grow-1">
                                        <div class="bg-light p-3 rounded">
                                            <h6 class="mb-1">أحمد</h6>
                                            <p class="mb-0">أحتاج مساعدة في مشروع العلوم يوم السبت</p>
                                            <small class="text-muted">منذ يوم</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- أفراد العائلة -->
                <div class="col-lg-6 mb-4">
                    <div class="card shadow h-100">
                        <div class="card-header py-3 d-flex justify-content-between align-items-center">
                            <h6 class="m-0 font-weight-bold text-primary">أفراد العائلة</h6>
                            <a href="members.html" class="btn btn-sm btn-primary">إدارة</a>
                        </div>
                        <div class="card-body">
                            <div class="row text-center" id="family-members">
                                <div class="col-4 mb-4">
                                    <img src="https://ui-avatars.com/api/?name=الأب&background=4e73df&color=fff" class="family-img mb-2">
                                    <h6>الأب</h6>
                                    <small class="text-muted">مدير العائلة</small>
                                </div>
                                <div class="col-4 mb-4">
                                    <img src="https://ui-avatars.com/api/?name=الأم&background=6f42c1&color=fff" class="family-img mb-2">
                                    <h6>الأم</h6>
                                    <small class="text-muted">إدارة المنزل</small>
                                </div>
                                <div class="col-4 mb-4">
                                    <img src="https://ui-avatars.com/api/?name=أحمد&background=1cc88a&color=fff" class="family-img mb-2">
                                    <h6>أحمد</h6>
                                    <small class="text-muted">الابن</small>
                                </div>
                                <div class="col-4 mb-4">
                                    <img src="https://ui-avatars.com/api/?name=سارة&background=e74a3b&color=fff" class="family-img mb-2">
                                    <h6>سارة</h6>
                                    <small class="text-muted">الابنة</small>
                                </div>
                                <div class="col-4 mb-4">
                                    <img src="https://ui-avatars.com/api/?name=فاطمة&background=f6c23e&color=fff" class="family-img mb-2">
                                    <h6>فاطمة</h6>
                                    <small class="text-muted">الابنة</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نموذج إضافة ملاحظة -->
    <div class="modal fade" id="addNoteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">إضافة ملاحظة جديدة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="noteForm">
                        <div class="mb-3">
                            <label class="form-label">نص الملاحظة</label>
                            <textarea class="form-control" rows="3" id="noteText" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">الأولوية</label>
                            <select class="form-select" id="notePriority">
                                <option value="normal" selected>عادية</option>
                                <option value="important">مهمة</option>
                                <option value="urgent">عاجلة</option>
                            </select>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="notifyAll">
                            <label class="form-check-label" for="notifyAll">إشعار الجميع بهذه الملاحظة</label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" id="saveNote">إضافة الملاحظة</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // بيانات التخزين المحلي (سيتم استبدالها بقاعدة بيانات في التطبيق الحقيقي)
        let familyData = JSON.parse(localStorage.getItem('familyData')) || {
            events: [
                { id: 1, title: 'حفل عيد ميلاد أحمد', date: 'غداً', time: '5:00 مساءً', location: 'منزلنا' },
                { id: 2, title: 'موعد طبيب سارة', date: 'بعد غد', time: '10:00 صباحاً', location: 'مستشفى المدينة' },
                { id: 3, title: 'اجتماع أولياء الأمور', date: 'الأسبوع القادم', time: '3:00 مساءً', location: 'مدرسة النخيل' }
            ],
            expenses: [
                { id: 1, category: 'البقالة', amount: 320, date: '20 أكتوبر' },
                { id: 2, category: 'فواتير الكهرباء', amount: 240, date: '18 أكتوبر' },
                { id: 3, category: 'مصاريف الدراسة', amount: 450, date: '15 أكتوبر' }
            ],
            notes: [
                { id: 1, author: 'الأب', content: 'لا تنسوا موعد الطبيب غداً الساعة 10 صباحاً', time: 'منذ ساعتين' },
                { id: 2, author: 'الأم', content: 'يجب شراء مستلزمات الدراسة للأطفال', time: 'منذ 5 ساعات' },
                { id: 3, author: 'أحمد', content: 'أحتاج مساعدة في مشروع العلوم يوم السبت', time: 'منذ يوم' }
            ],
            members: [
                { id: 1, name: 'الأب', role: 'مدير العائلة', image: 'https://ui-avatars.com/api/?name=الأب&background=4e73df&color=fff' },
                { id: 2, name: 'الأم', role: 'إدارة المنزل', image: 'https://ui-avatars.com/api/?name=الأم&background=6f42c1&color=fff' },
                { id: 3, name: 'أحمد', role: 'الابن', image: 'https://ui-avatars.com/api/?name=أحمد&background=1cc88a&color=fff' },
                { id: 4, name: 'سارة', role: 'الابنة', image: 'https://ui-avatars.com/api/?name=سارة&background=e74a3b&color=fff' },
                { id: 5, name: 'فاطمة', role: 'الابنة', image: 'https://ui-avatars.com/api/?name=فاطمة&background=f6c23e&color=fff' }
            ]
        };

        // دالة لحفظ البيانات في التخزين المحلي
        function saveData() {
            localStorage.setItem('familyData', JSON.stringify(familyData));
            updateDashboard();
        }

        // دالة لتحديث لوحة التحكم
        function updateDashboard() {
            // تحديث الإحصائيات
            document.getElementById('events-count').textContent = `${familyData.events.length} أحداث`;
            document.getElementById('notes-count').textContent = `${familyData.notes.length} ملاحظة`;
            document.getElementById('members-count').textContent = `${familyData.members.length} أفراد`;
            
            // حساب إجمالي المصروفات
            const totalExpenses = familyData.expenses.reduce((total, expense) => total + expense.amount, 0);
            document.getElementById('expenses-total').textContent = `${totalExpenses.toLocaleString()} ريال`;
            
            // تحديث الأحداث القادمة
            const eventsContainer = document.getElementById('upcoming-events');
            eventsContainer.innerHTML = '';
            familyData.events.forEach(event => {
                eventsContainer.innerHTML += `
                    <a href="#" class="list-group-item list-group-item-action family-event">
                        <div class="d-flex w-100 justify-content-between">
                            <h6 class="mb-1">${event.title}</h6>
                            <small>${event.date}</small>
                        </div>
                        <p class="mb-1">الوقت: ${event.time}</p>
                        <small>المكان: ${event.location}</small>
                    </a>
                `;
            });
            
            // تحديث الملاحظات
            const notesContainer = document.getElementById('family-notes');
            notesContainer.innerHTML = '';
            familyData.notes.forEach(note => {
                notesContainer.innerHTML += `
                    <div class="d-flex mb-4">
                        <img src="https://ui-avatars.com/api/?name=${note.author}&background=4e73df&color=fff" class="family-img me-3">
                        <div class="flex-grow-1">
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-1">${note.author}</h6>
                                <p class="mb-0">${note.content}</p>
                                <small class="text-muted">${note.time}</small>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            // تحديث أفراد العائلة
            const membersContainer = document.getElementById('family-members');
            membersContainer.innerHTML = '';
            familyData.members.forEach(member => {
                membersContainer.innerHTML += `
                    <div class="col-4 mb-4">
                        <img src="${member.image}" class="family-img mb-2">
                        <h6>${member.name}</h6>
                        <small class="text-muted">${member.role}</small>
                    </div>
                `;
            });
        }

        // إضافة ملاحظة جديدة
        document.getElementById('saveNote').addEventListener('click', function() {
            const noteText = document.getElementById('noteText').value;
            const notePriority = document.getElementById('notePriority').value;
            const notifyAll = document.getElementById('notifyAll').checked;
            
            if (noteText) {
                const newNote = {
                    id: familyData.notes.length + 1,
                    author: 'الأب', // المستخدم الحالي
                    content: noteText,
                    time: 'الآن'
                };
                
                familyData.notes.unshift(newNote);
                saveData();
                
                // إغلاق النموذج
                const modal = bootstrap.Modal.getInstance(document.getElementById('addNoteModal'));
                modal.hide();
                
                // إعادة تعيين النموذج
                document.getElementById('noteForm').reset();
            } else {
                alert('يرجى إدخال نص الملاحظة');
            }
        });

        // تهيئة البيانات عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            
            // محاكاة جلب البيانات من قاعدة البيانات
            console.log('جاري تحميل البيانات من قاعدة البيانات...');
            
            // هنا سيتم إضافة كود الاتصال بقاعدة البيانات باستخدام PHP وMySQL
            // مثال:
            /*
            fetch('get_dashboard_data.php')
                .then(response => response.json())
                .then(data => {
                    familyData = data;
                    updateDashboard();
                })
                .catch(error => console.error('Error:', error));
            */
        });
    </script>
</body>
</html>
